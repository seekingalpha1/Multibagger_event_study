<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winner Stocks Analysis - Summary Statistics</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        
        .filter-section {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .filter-group {
            margin-bottom: 15px;
        }
        
        .filter-group h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 14px;
            font-weight: 600;
        }
        
        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .filter-buttons button {
            padding: 8px 16px;
            background-color: #ecf0f1;
            color: #2c3e50;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .filter-buttons button:hover {
            background-color: #d5dbdd;
        }
        
        .filter-buttons button.active {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .table-container {
            overflow-x: auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 10px;
        }
        
        th {
            background-color: #34495e;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            border: 1px solid #2c3e50;
            font-size: 12px;
        }
        
        td {
            padding: 10px 8px;
            border: 1px solid #ecf0f1;
            text-align: center;
            font-size: 13px;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e8f4f8;
        }
        
        .multiple-col {
            font-weight: bold;
            color: #2c3e50;
            background-color: #ecf0f1 !important;
            font-size: 14px;
        }
        
        /* Hide columns by default, show when active */
        .col-hidden {
            display: none !important;
        }
        
        .range-value {
            white-space: nowrap;
        }
        
        .range-value .small {
            font-size: 10px;
            color: #7f8c8d;
        }
        
        .range-value .mid {
            font-weight: bold;
            font-size: 13px;
            margin: 0 3px;
        }
        
        .info-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            padding: 25px;
            margin-bottom: 20px;
            color: white;
        }
        
        .info-section h2 {
            margin: 0 0 20px 0;
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            background-color: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .info-item .label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .info-item .value {
            font-size: 18px;
            font-weight: 600;
        }
        
        .info-item .description {
            font-size: 12px;
            opacity: 0.85;
            margin-top: 5px;
            line-height: 1.4;
        }
        
        .info-meta {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 12px;
            opacity: 0.9;
        }
        
        .info-meta strong {
            font-weight: 600;
        }

        .prob-higher-list {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .prob-item {
            background-color: #eaf2f8;
            border-radius: 3px;
            padding: 1px 5px;
            font-size: 11px;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <h1>üìä Winner Stocks Analysis</h1>
    <p class="subtitle">Performance after achieving 2x-10x returns</p>
    
    <div class="info-section">
        <h2>‚öôÔ∏è Analysis Configuration</h2>
        <div class="info-grid">
            <div class="info-item">
                <div class="label">Entry Point Definition</div>
                <div class="value">{{ROLLING_WINDOW}} days ({{PERCENTILE}}th percentile)</div>
                <div class="description">Rolling minimum over 1 year period to define realistic entry price</div>
            </div>
            
            <div class="info-item">
                <div class="label">Cooldown Period</div>
                <div class="value">{{COOLDOWN_DAYS}} days</div>
                <div class="description">Minimum time between multiple-crossing events for the same stock</div>
            </div>
            
            <div class="info-item">
                <div class="label">Multiples Analyzed</div>
                <div class="value">{{MULTIPLES}}</div>
                <div class="description">Performance tracked after crossing each threshold</div>
            </div>
            
            <div class="info-item">
                <div class="label">Follow-Up Periods</div>
                <div class="value">1Y, 2Y, 3Y, 5Y, 10Y</div>
                <div class="description">Forward-looking time horizons for performance analysis</div>
            </div>
            
            <div class="info-item">
                <div class="label">Data Period</div>
                <div class="value">{{DATE_RANGE_START}} to {{DATE_RANGE_END}}</div>
                <div class="description">Historical price data analyzed</div>
            </div>
            
            <div class="info-item">
                <div class="label">Total Events</div>
                <div class="value">{{TOTAL_EVENTS}}</div>
                <div class="description">Number of multiple-crossing events detected across all stocks</div>
            </div>
        </div>
        
        <div class="info-meta">
            <strong>Methodology:</strong> This analysis identifies when stocks cross performance multiples (2x, 3x, etc.) relative to their rolling entry price, 
            then tracks subsequent performance over various time horizons. The rolling entry price prevents survivorship bias and provides a realistic baseline.
        </div>
    </div>
    
    <div class="filter-section">
        <div class="filter-group">
            <h3>üìÖ Time Periods</h3>
            <div class="filter-buttons">
                <button onclick="togglePeriod('1Y')" class="period-btn active" id="period-1Y">1 Year</button>
                <button onclick="togglePeriod('2Y')" class="period-btn active" id="period-2Y">2 Years</button>
                <button onclick="togglePeriod('3Y')" class="period-btn active" id="period-3Y">3 Years</button>
                <button onclick="togglePeriod('5Y')" class="period-btn active" id="period-5Y">5 Years</button>
                <button onclick="togglePeriod('10Y')" class="period-btn active" id="period-10Y">10 Years</button>
            </div>
        </div>
        
        <div class="filter-group">
            <h3>üìä Metrics</h3>
            <div class="filter-buttons">
                <button onclick="toggleMetric('prob_higher')" class="metric-btn active" id="metric-prob_higher">Prob Higher Multiples</button>
                <button onclick="toggleMetric('days')" class="metric-btn active" id="metric-days">Avg Days Next</button>
                <button onclick="toggleMetric('mdd_next')" class="metric-btn active" id="metric-mdd_next">MDD Until Next</button>
                <button onclick="toggleMetric('return_not_next')" class="metric-btn active" id="metric-return_not_next">Return Not Next</button>
                <button onclick="toggleMetric('return')" class="metric-btn active" id="metric-return">Return Range</button>
            </div>
        </div>
        
        <div class="filter-group">
            <h3>‚ö° Quick Actions</h3>
            <div class="filter-buttons">
                <button onclick="selectAllPeriods()">All Periods</button>
                <button onclick="deselectAllPeriods()">Clear Periods</button>
                <button onclick="selectAllMetrics()">All Metrics</button>
                <button onclick="deselectAllMetrics()">Clear Metrics</button>
                <button onclick="resetFilters()">Reset All</button>
            </div>
        </div>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th rowspan="2" class="multiple-col">Multiple</th>
                    <th rowspan="2">Events</th>
                    {{PERIOD_HEADERS}}
                </tr>
                <tr>
                    {{METRIC_HEADERS}}
                </tr>
            </thead>
            <tbody>
                {{TABLE_ROWS}}
            </tbody>
        </table>
    </div>
    
    <script>
        // Active periods and metrics
        let activePeriods = new Set(['1Y', '2Y', '3Y', '5Y', '10Y']);
        let activeMetrics = new Set(['prob_higher', 'days', 'mdd_next', 'return_not_next', 'return']);
        
        function togglePeriod(period) {
            const btn = document.getElementById('period-' + period);
            
            if (activePeriods.has(period)) {
                activePeriods.delete(period);
                btn.classList.remove('active');
            } else {
                activePeriods.add(period);
                btn.classList.add('active');
            }
            
            updateTable();
        }
        
        function toggleMetric(metric) {
            const btn = document.getElementById('metric-' + metric);
            
            if (activeMetrics.has(metric)) {
                activeMetrics.delete(metric);
                btn.classList.remove('active');
            } else {
                activeMetrics.add(metric);
                btn.classList.add('active');
            }
            
            updateTable();
        }
        
        function updateTable() {
            // Update period headers (colspan headers)
            document.querySelectorAll('th[data-period]').forEach(header => {
                const period = header.getAttribute('data-period');
                if (activePeriods.has(period)) {
                    header.classList.remove('col-hidden');
                    // Update colspan dynamically
                    header.setAttribute('colspan', activeMetrics.size);
                } else {
                    header.classList.add('col-hidden');
                }
            });
            
            // Update metric headers and cells
            // Only show if BOTH the period AND the metric are active
            document.querySelectorAll('[data-period-metric]').forEach(element => {
                const attr = element.getAttribute('data-period-metric');
                const [period, metric] = attr.split('-');
                
                if (activePeriods.has(period) && activeMetrics.has(metric)) {
                    element.classList.remove('col-hidden');
                } else {
                    element.classList.add('col-hidden');
                }
            });
        }
        
        function selectAllPeriods() {
            activePeriods = new Set(['1Y', '2Y', '3Y', '5Y', '10Y']);
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.add('active'));
            updateTable();
        }
        
        function deselectAllPeriods() {
            activePeriods = new Set();
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
            updateTable();
        }
        
        function selectAllMetrics() {
            activeMetrics = new Set(['prob_higher', 'days', 'mdd_next', 'return_not_next', 'return']);
            document.querySelectorAll('.metric-btn').forEach(btn => btn.classList.add('active'));
            updateTable();
        }
        
        function deselectAllMetrics() {
            activeMetrics = new Set();
            document.querySelectorAll('.metric-btn').forEach(btn => btn.classList.remove('active'));
            updateTable();
        }
        
        function resetFilters() {
            selectAllPeriods();
            selectAllMetrics();
        }
        
        // Initialize table
        updateTable();
    </script>
</body>
</html>